{% extends 'store/layouts/main.html' %}
{% load static %}
{% block content %}

<section class="vh-100" style="background-color: #fdccbc;">
  <div class="container h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      {% if request.user.is_authenticated  %}
      <div class="col">
        <p><span class="h2">Shopping Cart </span><span class="h4">({{ cart.num_of_product }} item in your cart)</span></p>

        <div class="card mb-4">
          <div class="card-body p-4">
            {% for item in items %}
            
            
            <div class="row align-items-center">
              <div class="col-md-2">
                <img src="{{ item.product.image.url }}"
                  class="img-fluid" alt="Generic placeholder image">
              </div>

              <div class="col-md-2 d-flex justify-content-center">
                <div>
                  <p class="small text-muted mb-4 pb-2">Name</p>
                  <p class="lead fw-normal mb-0">{{ item.product.name }}</p>
                </div>
              </div>

              <div class="col-md-2 d-flex justify-content-center">
                <div>
                  <p class="small text-muted mb-4 pb-2">Quantity</p>
                  <button class="decrement-btn btn minus-btn " type="button" value="{{ item.product.id }}" >-</button>
                  <input type="text" id="quantity" value="{{ item.quantity }}">
                  <button class="increment-btn btn plus-btn" type="button" value="{{ item.product.id }}" >+</button>
                </div>
              </div>

              <div class="col-md-2 d-flex justify-content-center">
                <div>
                  <p class="small text-muted mb-4 pb-2">Price</p>
                  <p class="lead fw-normal mb-0">${{ item.product.selling_price }}</p>
                </div>
              </div>

              <div class="col-md-2 d-flex justify-content-center">
                <div>
                  <p class="small text-muted mb-4 pb-2">Remove</p>
                  <a href="{% url 'remove_product' item.id %}" class="fas fa-trash"></a>
                </div>
              </div>
              <div class="col-md-2 d-flex justify-content-center">
                <div>
                  <p class="small text-muted mb-4 pb-2">Total</p>
                  <p class="lead fw-normal mb-0" id="total">$ {{ item.price }}   </p>
                </div>
              </div>

            </div>
            
            {% endfor %}
          </div>
        </div>
        <div class="card mb-5">
          <div class="card-body p-4">

            <div class="float-end">
              <p class="mb-0 me-5 d-flex align-items-center">
                <span class="small text-muted me-2">Order total:</span> <span
                  class="lead fw-normal">${{cart.total_price}}</span>
              </p>
            </div>

          </div>
        </div>

        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-light btn-lg me-2"><a href="{% url 'home' %}" class="btn btn-light btn-lg me-2">Back home</a> </button>
          <button type="button" class="btn btn-primary btn-lg">Checkout</button>
        </div>

      </div>
      {% else %}
      <p><span class="h2">ko co san pham trong gio hang </span></p>
      <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-light btn-lg me-2"><a href="{% url 'home' %}" style="text-decoration: none;">Back home</a> </button>
        <button type="button" class="btn btn-primary btn-lg me-2">Checkout</button>
      </div>
      {% endif %}
    </div>
  </div>
</section>

<script>
  //setting default attribute to disabled of minus button
  document.querySelector(".minus-btn").setAttribute("disabled", "disabled");

  //taking value to increment decrement input value
  var valueCount

  //taking price value in variable
  var price = document.getElementById("price").innerText;

  //price calculation function
  function priceTotal() {
      var total = valueCount * price;
      document.getElementById("price").innerText = total
  }

  //plus button
  document.querySelector(".plus-btn").addEventListener("click", function() {
      //getting value of input
      valueCount = document.getElementById("quantity").value;

      //input value increment by 1
      valueCount++;

      //setting increment input value
      document.getElementById("quantity").value = valueCount;

      if (valueCount > 1) {
          document.querySelector(".minus-btn").removeAttribute("disabled");
          document.querySelector(".minus-btn").classList.remove("disabled")
      }

      //calling price function
      priceTotal()
  })

  //plus button
  document.querySelector(".minus-btn").addEventListener("click", function() {
      //getting value of input
      valueCount = document.getElementById("quantity").value;

      //input value increment by 1
      valueCount--;

      //setting increment input value
      document.getElementById("quantity").value = valueCount

      if (valueCount == 1) {
          document.querySelector(".minus-btn").setAttribute("disabled", "disabled")
      }

      //calling price function
      priceTotal()
  })
</script>




{% block scripts %}
<script src="{% static 'js/a.js' %}" ></script>
{% endblock scripts %}

{% endblock content %}

